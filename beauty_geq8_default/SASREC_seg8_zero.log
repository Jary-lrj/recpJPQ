nohup: ignoring input
average sequence length: 5.94
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (2) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (7) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (38) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (148) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (51) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (8) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (1) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/sklearn/base.py:1152: ConvergenceWarning: Number of distinct clusters (1) found smaller than n_clusters (256). Possibly due to duplicate points in X.
  return fit_method(estimator, *args, **kwargs)
Duplicate Rows: 1
item_emb.weight: 4840000
pos_emb.weight: 80400
attention_layernorms.0.weight: 400
attention_layernorms.0.bias: 400
attention_layernorms.1.weight: 400
attention_layernorms.1.bias: 400
attention_layers.0.in_proj_weight: 480000
attention_layers.0.in_proj_bias: 1200
attention_layers.0.out_proj.weight: 160000
attention_layers.0.out_proj.bias: 400
attention_layers.1.in_proj_weight: 480000
attention_layers.1.in_proj_bias: 1200
attention_layers.1.out_proj.weight: 160000
attention_layers.1.out_proj.bias: 400
forward_layernorms.0.weight: 400
forward_layernorms.0.bias: 400
forward_layernorms.1.weight: 400
forward_layernorms.1.bias: 400
forward_layers.0.conv1.weight: 160000
forward_layers.0.conv1.bias: 400
forward_layers.0.conv2.weight: 160000
forward_layers.0.conv2.bias: 400
forward_layers.1.conv1.weight: 160000
forward_layers.1.conv1.bias: 400
forward_layers.1.conv2.weight: 160000
forward_layers.1.conv2.bias: 400
last_layernorm.weight: 400
last_layernorm.bias: 400
item_code.centroids: 102400
avg loss in epoch 1: 1.2670113051479512
avg loss in epoch 2: 1.1908566247333179
avg loss in epoch 3: 1.180314609950239
avg loss in epoch 4: 1.1652573184533552
avg loss in epoch 5: 1.163422163237225
avg loss in epoch 6: 1.1619271798567339
avg loss in epoch 7: 1.1538705974817276
avg loss in epoch 8: 1.1550722731785341
avg loss in epoch 9: 1.1521376940337094
avg loss in epoch 10: 1.146818303249099
avg loss in epoch 11: 1.148929621685635
avg loss in epoch 12: 1.1452989063479684
avg loss in epoch 13: 1.1408068984746933
avg loss in epoch 14: 1.1420805196870456
avg loss in epoch 15: 1.1400020190260627
avg loss in epoch 16: 1.1377147219397805
avg loss in epoch 17: 1.136284050616351
avg loss in epoch 18: 1.1354690871455453
avg loss in epoch 19: 1.1337770399722187
avg loss in epoch 20: 1.1319405124946074
Evaluating....................................................................................................................................................................................................epoch:20, time: 791.024335(s), valid (NDCG@10: 0.2327, HR@10: 0.3882), test (NDCG@10: 0.2375, HR@10: 0.3910)
Current best result: value_NDCG 0.23266866046868656, value_HR 0.3882436837815811, test_NDCG 0.2374889445959272, test_HR 0.3909904413260118
avg loss in epoch 21: 1.1316422684626146
avg loss in epoch 22: 1.1250629966909236
avg loss in epoch 23: 1.1287603676319122
avg loss in epoch 24: 1.1245049062100323
avg loss in epoch 25: 1.1214491467584262
avg loss in epoch 26: 1.1237985220822422
avg loss in epoch 27: 1.1222364143891768
avg loss in epoch 28: 1.1158834790641612
avg loss in epoch 29: 1.1199032813310623
avg loss in epoch 30: 1.1168984106995843
avg loss in epoch 31: 1.1149976768276908
avg loss in epoch 32: 1.1171489046378569
avg loss in epoch 33: 1.114803291179917
avg loss in epoch 34: 1.1113146516409786
avg loss in epoch 35: 1.1109537102959373
avg loss in epoch 36: 1.1090732677416368
avg loss in epoch 37: 1.107041746377945
avg loss in epoch 38: 1.1103519743139094
avg loss in epoch 39: 1.1073313057422638
avg loss in epoch 40: 1.1055428697304293
Evaluating....................................................................................................................................................................................................epoch:40, time: 1576.954143(s), valid (NDCG@10: 0.2351, HR@10: 0.3848), test (NDCG@10: 0.2408, HR@10: 0.3957)
Current best result: value_NDCG 0.2351082446141905, value_HR 0.3882436837815811, test_NDCG 0.24081668151575225, test_HR 0.3957273652085453
avg loss in epoch 41: 1.100279686125842
avg loss in epoch 42: 1.1055543382059445
avg loss in epoch 43: 1.10318454422734
avg loss in epoch 44: 1.1003969392993234
avg loss in epoch 45: 1.1002747551961378
avg loss in epoch 46: 1.098650645125996
avg loss in epoch 47: 1.0950698053294963
avg loss in epoch 48: 1.101186454296112
avg loss in epoch 49: 1.098733740774068
avg loss in epoch 50: 1.0926254147833043
avg loss in epoch 51: 1.0961763249202208
avg loss in epoch 52: 1.095862696116621
avg loss in epoch 53: 1.0917315252802589
avg loss in epoch 54: 1.0910597077824853
avg loss in epoch 55: 1.089763730764389
avg loss in epoch 56: 1.0860743441364982
avg loss in epoch 57: 1.0865446667779575
avg loss in epoch 58: 1.0893748212944379
avg loss in epoch 59: 1.0845044539733366
avg loss in epoch 60: 1.0864628485657952
Evaluating....................................................................................................................................................................................................epoch:60, time: 2323.281628(s), valid (NDCG@10: 0.2359, HR@10: 0.3876), test (NDCG@10: 0.2445, HR@10: 0.4005)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
avg loss in epoch 61: 1.0871531191197308
avg loss in epoch 62: 1.0811193571849302
avg loss in epoch 63: 1.0827835947275162
avg loss in epoch 64: 1.0792180868712338
avg loss in epoch 65: 1.079110336574641
avg loss in epoch 66: 1.0786098052154889
avg loss in epoch 67: 1.0810062682086772
avg loss in epoch 68: 1.0732962516221134
avg loss in epoch 69: 1.0787416235967116
avg loss in epoch 70: 1.077173944224011
avg loss in epoch 71: 1.075382174416022
avg loss in epoch 72: 1.0765624899755826
avg loss in epoch 73: 1.0751911902969533
avg loss in epoch 74: 1.06971053508195
avg loss in epoch 75: 1.0746093487197703
avg loss in epoch 76: 1.0706140168688514
avg loss in epoch 77: 1.0676952309229157
avg loss in epoch 78: 1.0678748827088962
avg loss in epoch 79: 1.0714774565263228
avg loss in epoch 80: 1.0700675953518262
Evaluating....................................................................................................................................................................................................epoch:80, time: 2919.591706(s), valid (NDCG@10: 0.2322, HR@10: 0.3814), test (NDCG@10: 0.2409, HR@10: 0.3921)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
avg loss in epoch 81: 1.0689899867231196
avg loss in epoch 82: 1.0681592510505156
avg loss in epoch 83: 1.0649632621895184
avg loss in epoch 84: 1.063284699212421
avg loss in epoch 85: 1.067070635882291
avg loss in epoch 86: 1.0599398132074962
avg loss in epoch 87: 1.0630440413951874
avg loss in epoch 88: 1.0640574422749607
avg loss in epoch 89: 1.0608012947169216
avg loss in epoch 90: 1.0648503073237159
avg loss in epoch 91: 1.0578589886426926
avg loss in epoch 92: 1.055742702700875
avg loss in epoch 93: 1.0588716864585876
avg loss in epoch 94: 1.0569731281562285
avg loss in epoch 95: 1.0573920878497036
avg loss in epoch 96: 1.0557584044608204
avg loss in epoch 97: 1.054605060680346
avg loss in epoch 98: 1.0550471625544808
avg loss in epoch 99: 1.0562999221411618
avg loss in epoch 100: 1.0536398393186657
Evaluating....................................................................................................................................................................................................epoch:100, time: 3535.682111(s), valid (NDCG@10: 0.2306, HR@10: 0.3831), test (NDCG@10: 0.2357, HR@10: 0.3854)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
avg loss in epoch 101: 1.0537021200765262
avg loss in epoch 102: 1.049350648441098
avg loss in epoch 103: 1.0520884069529446
avg loss in epoch 104: 1.0492856604131786
avg loss in epoch 105: 1.0483527738939633
avg loss in epoch 106: 1.049313029105013
avg loss in epoch 107: 1.049227018247951
avg loss in epoch 108: 1.0497275631536136
avg loss in epoch 109: 1.047491498968818
avg loss in epoch 110: 1.0446701523932544
avg loss in epoch 111: 1.0476506921378048
avg loss in epoch 112: 1.0450475439429283
avg loss in epoch 113: 1.046545533971353
avg loss in epoch 114: 1.0422559515996412
avg loss in epoch 115: 1.0462648076089947
avg loss in epoch 116: 1.0422751795161853
avg loss in epoch 117: 1.0429095442999492
avg loss in epoch 118: 1.0429597239602695
avg loss in epoch 119: 1.0384590558030389
avg loss in epoch 120: 1.0431084429675883
Evaluating....................................................................................................................................................................................................epoch:120, time: 4079.077283(s), valid (NDCG@10: 0.2298, HR@10: 0.3799), test (NDCG@10: 0.2315, HR@10: 0.3864)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
avg loss in epoch 121: 1.0399421189319005
avg loss in epoch 122: 1.0411797910928726
avg loss in epoch 123: 1.0390739528970285
avg loss in epoch 124: 1.038992501795292
avg loss in epoch 125: 1.038278686052019
avg loss in epoch 126: 1.0378924337300388
avg loss in epoch 127: 1.0378971865231341
avg loss in epoch 128: 1.0405838841741735
avg loss in epoch 129: 1.0343544462865049
avg loss in epoch 130: 1.0368042716925794
avg loss in epoch 131: 1.0321281030774117
avg loss in epoch 132: 1.0324004292488098
avg loss in epoch 133: 1.0335076810284094
avg loss in epoch 134: 1.0340025587515398
avg loss in epoch 135: 1.0351730266755277
avg loss in epoch 136: 1.0362241986122998
avg loss in epoch 137: 1.0350332896817813
avg loss in epoch 138: 1.0320493111556226
avg loss in epoch 139: 1.0346500968391246
avg loss in epoch 140: 1.0338611453771591
Evaluating....................................................................................................................................................................................................epoch:140, time: 4582.354098(s), valid (NDCG@10: 0.2281, HR@10: 0.3730), test (NDCG@10: 0.2367, HR@10: 0.3883)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
avg loss in epoch 141: 1.0295172144066205
avg loss in epoch 142: 1.031905777075074
avg loss in epoch 143: 1.035828746855259
avg loss in epoch 144: 1.031454811719331
avg loss in epoch 145: 1.0316650386561046
avg loss in epoch 146: 1.0277109958908774
avg loss in epoch 147: 1.029912418262525
avg loss in epoch 148: 1.0285122889009388
avg loss in epoch 149: 1.0259908485141667
avg loss in epoch 150: 1.026694193482399
avg loss in epoch 151: 1.0313762785358862
avg loss in epoch 152: 1.0295828675681895
avg loss in epoch 153: 1.0284999459981918
avg loss in epoch 154: 1.028294219889424
avg loss in epoch 155: 1.0249384892257778
avg loss in epoch 156: 1.0246344371275469
avg loss in epoch 157: 1.0235092816027729
avg loss in epoch 158: 1.0264175324277445
avg loss in epoch 159: 1.025590566071597
avg loss in epoch 160: 1.0190049267627976
Evaluating....................................................................................................................................................................................................epoch:160, time: 5077.555356(s), valid (NDCG@10: 0.2330, HR@10: 0.3788), test (NDCG@10: 0.2375, HR@10: 0.3850)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
avg loss in epoch 161: 1.0269014936956493
avg loss in epoch 162: 1.0259607115929776
avg loss in epoch 163: 1.0231590480967
avg loss in epoch 164: 1.022884952751073
avg loss in epoch 165: 1.0236823016946965
avg loss in epoch 166: 1.020312225954099
avg loss in epoch 167: 1.0246155681935223
avg loss in epoch 168: 1.023553622717207
avg loss in epoch 169: 1.020523575219241
avg loss in epoch 170: 1.0238110788843848
avg loss in epoch 171: 1.0237898210232907
avg loss in epoch 172: 1.0194665471261197
avg loss in epoch 173: 1.0163392634554342
avg loss in epoch 174: 1.0226186114278706
avg loss in epoch 175: 1.0216237665577368
avg loss in epoch 176: 1.0213197415525264
avg loss in epoch 177: 1.02359236438166
avg loss in epoch 178: 1.0168318470770663
avg loss in epoch 179: 1.0162406333468177
avg loss in epoch 180: 1.0204339359294285
Evaluating....................................................................................................................................................................................................epoch:180, time: 5563.979466(s), valid (NDCG@10: 0.2320, HR@10: 0.3756), test (NDCG@10: 0.2347, HR@10: 0.3852)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
avg loss in epoch 181: 1.0184377953410149
avg loss in epoch 182: 1.0178996913812377
avg loss in epoch 183: 1.0171242403713139
avg loss in epoch 184: 1.0183343264189633
avg loss in epoch 185: 1.017601609907367
avg loss in epoch 186: 1.0172752765091984
avg loss in epoch 187: 1.0124618472023443
avg loss in epoch 188: 1.0192441994493657
avg loss in epoch 189: 1.016908092254942
avg loss in epoch 190: 1.0129855620590122
avg loss in epoch 191: 1.0212567164139315
avg loss in epoch 192: 1.0178509679707615
avg loss in epoch 193: 1.0158531950278715
avg loss in epoch 194: 1.016920238055966
avg loss in epoch 195: 1.015561510216106
avg loss in epoch 196: 1.0133433951572939
avg loss in epoch 197: 1.0141426649960605
avg loss in epoch 198: 1.0174996500665492
avg loss in epoch 199: 1.0121583491563797
avg loss in epoch 200: 1.0160929310050877
Evaluating....................................................................................................................................................................................................epoch:200, time: 6050.889281(s), valid (NDCG@10: 0.2280, HR@10: 0.3713), test (NDCG@10: 0.2314, HR@10: 0.3837)
Current best result: value_NDCG 0.23593275554327897, value_HR 0.3882436837815811, test_NDCG 0.2445208937565869, test_HR 0.4005291543706116
Done
