nohup: ignoring input
average sequence length: 5.94
item_emb.weight: 3630000
pos_emb.weight: 60300
attention_layernorms.0.weight: 300
attention_layernorms.0.bias: 300
attention_layernorms.1.weight: 300
attention_layernorms.1.bias: 300
attention_layers.0.in_proj_weight: 270000
attention_layers.0.in_proj_bias: 900
attention_layers.0.out_proj.weight: 90000
attention_layers.0.out_proj.bias: 300
attention_layers.1.in_proj_weight: 270000
attention_layers.1.in_proj_bias: 900
attention_layers.1.out_proj.weight: 90000
attention_layers.1.out_proj.bias: 300
forward_layernorms.0.weight: 300
forward_layernorms.0.bias: 300
forward_layernorms.1.weight: 300
forward_layernorms.1.bias: 300
forward_layers.0.conv1.weight: 90000
forward_layers.0.conv1.bias: 300
forward_layers.0.conv2.weight: 90000
forward_layers.0.conv2.bias: 300
forward_layers.1.conv1.weight: 90000
forward_layers.1.conv1.bias: 300
forward_layers.1.conv2.weight: 90000
forward_layers.1.conv2.bias: 300
last_layernorm.weight: 300
last_layernorm.bias: 300
avg loss in epoch 1: 1.2056997391310604
avg loss in epoch 2: 1.040777514604005
avg loss in epoch 3: 0.9196349070830778
avg loss in epoch 4: 0.7700010924176737
avg loss in epoch 5: 0.6542827886613932
avg loss in epoch 6: 0.5521351220932874
avg loss in epoch 7: 0.4612859162417325
avg loss in epoch 8: 0.39088881185108965
avg loss in epoch 9: 0.3348803330551494
avg loss in epoch 10: 0.28348274613645946
avg loss in epoch 11: 0.24845956079661846
avg loss in epoch 12: 0.21615963886407288
avg loss in epoch 13: 0.19317363338036972
avg loss in epoch 14: 0.17058434405110098
avg loss in epoch 15: 0.1584766839038242
avg loss in epoch 16: 0.14451264251362195
avg loss in epoch 17: 0.13407234263352372
avg loss in epoch 18: 0.12460741713981736
avg loss in epoch 19: 0.11614434471861883
avg loss in epoch 20: 0.10804956948215311
Evaluating....................................................................................................................................................................................................epoch:20, time: 90.262941(s), valid (NDCG@10: 0.3183, HR@10: 0.4644), test (NDCG@10: 0.3018, HR@10: 0.4566)
Current best result: value_NDCG0.3182677897921593, value_HR0.46438775510204083, test_NDCG0.3018427963851399, test_HR0.45655495568911075
avg loss in epoch 21: 0.1054331199689345
avg loss in epoch 22: 0.09879632471975955
avg loss in epoch 23: 0.0964314036748626
avg loss in epoch 24: 0.09131028333848173
avg loss in epoch 25: 0.08820008317177946
avg loss in epoch 26: 0.08573541819879954
avg loss in epoch 27: 0.08309619378467853
avg loss in epoch 28: 0.07984201415357264
avg loss in epoch 29: 0.07884129132567481
avg loss in epoch 30: 0.07660229000347582
avg loss in epoch 31: 0.07590829678387805
avg loss in epoch 32: 0.07311044265092774
avg loss in epoch 33: 0.07009457563981414
avg loss in epoch 34: 0.06992982247505676
avg loss in epoch 35: 0.06949882666495713
avg loss in epoch 36: 0.06747009414671497
avg loss in epoch 37: 0.06769914213906635
avg loss in epoch 38: 0.06699078491973606
avg loss in epoch 39: 0.06478915511715141
avg loss in epoch 40: 0.0650328182276677
Evaluating....................................................................................................................................................................................................epoch:40, time: 260.422326(s), valid (NDCG@10: 0.3052, HR@10: 0.4404), test (NDCG@10: 0.2807, HR@10: 0.4297)
avg loss in epoch 41: 0.06472204447808591
avg loss in epoch 42: 0.06331831441176208
avg loss in epoch 43: 0.06285344504497269
avg loss in epoch 44: 0.06204011291265488
avg loss in epoch 45: 0.06008020741865039
avg loss in epoch 46: 0.06303268709135326
avg loss in epoch 47: 0.06114407383244146
avg loss in epoch 48: 0.05885629838501865
avg loss in epoch 49: 0.05740141949023713
avg loss in epoch 50: 0.058578323826871136
avg loss in epoch 51: 0.05808950249444355
avg loss in epoch 52: 0.057599270419979635
avg loss in epoch 53: 0.05747340179302476
avg loss in epoch 54: 0.0576105686751279
avg loss in epoch 55: 0.05656426793641665
avg loss in epoch 56: 0.056273813190108
avg loss in epoch 57: 0.05509500637311827
avg loss in epoch 58: 0.05474468375640837
avg loss in epoch 59: 0.05617010603997518
avg loss in epoch 60: 0.055415914224630054
Evaluating....................................................................................................................................................................................................epoch:60, time: 349.873515(s), valid (NDCG@10: 0.2984, HR@10: 0.4393), test (NDCG@10: 0.2766, HR@10: 0.4214)
avg loss in epoch 61: 0.054392285623841664
avg loss in epoch 62: 0.05221044473265382
avg loss in epoch 63: 0.052882596088404
avg loss in epoch 64: 0.05386551456864585
avg loss in epoch 65: 0.051640637261285025
avg loss in epoch 66: 0.052204353756017306
avg loss in epoch 67: 0.05204519716260785
avg loss in epoch 68: 0.05339226018722085
avg loss in epoch 69: 0.053290111711248755
avg loss in epoch 70: 0.05353567298417064
avg loss in epoch 71: 0.053277568108486856
avg loss in epoch 72: 0.051554576895961705
avg loss in epoch 73: 0.05093713223256848
avg loss in epoch 74: 0.052896907002749766
avg loss in epoch 75: 0.05054114936766299
avg loss in epoch 76: 0.050660197072747076
avg loss in epoch 77: 0.05079916657202623
avg loss in epoch 78: 0.05022862468930808
avg loss in epoch 79: 0.04996702098287642
avg loss in epoch 80: 0.049027302133088764
Evaluating....................................................................................................................................................................................................epoch:80, time: 520.263949(s), valid (NDCG@10: 0.2908, HR@10: 0.4272), test (NDCG@10: 0.2612, HR@10: 0.3979)
avg loss in epoch 81: 0.04894574867053465
avg loss in epoch 82: 0.04949386642229828
avg loss in epoch 83: 0.05023199010809714
avg loss in epoch 84: 0.049739754631776704
avg loss in epoch 85: 0.04841501572677358
avg loss in epoch 86: 0.050041604236784304
avg loss in epoch 87: 0.045572309670123184
avg loss in epoch 88: 0.04875912803055888
avg loss in epoch 89: 0.05028218706138432
avg loss in epoch 90: 0.049137406178157435
avg loss in epoch 91: 0.046871217391030354
avg loss in epoch 92: 0.04900644478303465
avg loss in epoch 93: 0.050034247698600993
avg loss in epoch 94: 0.04822980299253355
avg loss in epoch 95: 0.048106581501832064
avg loss in epoch 96: 0.046541818481108006
avg loss in epoch 97: 0.045163303380832076
avg loss in epoch 98: 0.046303701819851995
avg loss in epoch 99: 0.04643894255753945
avg loss in epoch 100: 0.04433839636939493
Evaluating....................................................................................................................................................................................................epoch:100, time: 653.931549(s), valid (NDCG@10: 0.2928, HR@10: 0.4270), test (NDCG@10: 0.2648, HR@10: 0.4083)
avg loss in epoch 101: 0.04766352561471814
avg loss in epoch 102: 0.046035308158025146
avg loss in epoch 103: 0.048222829016264186
avg loss in epoch 104: 0.049256505190648815
avg loss in epoch 105: 0.04591443965380842
avg loss in epoch 106: 0.04778030859729783
avg loss in epoch 107: 0.04513681675730781
avg loss in epoch 108: 0.04625977918675
avg loss in epoch 109: 0.047379045937718314
avg loss in epoch 110: 0.046310120579701936
avg loss in epoch 111: 0.04485575031404468
avg loss in epoch 112: 0.04674417703327807
avg loss in epoch 113: 0.04730904299173166
avg loss in epoch 114: 0.046253268479962244
avg loss in epoch 115: 0.044796300268816674
avg loss in epoch 116: 0.04854772877032784
avg loss in epoch 117: 0.04426045366562903
avg loss in epoch 118: 0.04554726962338795
avg loss in epoch 119: 0.045303166039626704
avg loss in epoch 120: 0.04349749492989345
Evaluating....................................................................................................................................................................................................epoch:120, time: 815.132946(s), valid (NDCG@10: 0.2933, HR@10: 0.4293), test (NDCG@10: 0.2742, HR@10: 0.4154)
avg loss in epoch 121: 0.043825119818476116
avg loss in epoch 122: 0.044540811838074165
avg loss in epoch 123: 0.0458483283450319
avg loss in epoch 124: 0.0413272389083762
avg loss in epoch 125: 0.0430144784887406
avg loss in epoch 126: 0.0458935247734189
avg loss in epoch 127: 0.043851862238212067
avg loss in epoch 128: 0.044702397236092525
avg loss in epoch 129: 0.0464489029889757
avg loss in epoch 130: 0.043653833849186245
avg loss in epoch 131: 0.0457083354704082
avg loss in epoch 132: 0.04137931745076044
avg loss in epoch 133: 0.046579917300153866
avg loss in epoch 134: 0.042514412282881414
avg loss in epoch 135: 0.044771985383704305
avg loss in epoch 136: 0.04194306036118756
avg loss in epoch 137: 0.043880208310755814
avg loss in epoch 138: 0.04517513752745634
avg loss in epoch 139: 0.0447312255220657
avg loss in epoch 140: 0.0432824576696889
Evaluating....................................................................................................................................................................................................epoch:140, time: 981.995465(s), valid (NDCG@10: 0.2960, HR@10: 0.4276), test (NDCG@10: 0.2647, HR@10: 0.4027)
avg loss in epoch 141: 0.04250590526498854
avg loss in epoch 142: 0.04172526706348766
avg loss in epoch 143: 0.044125072975558316
avg loss in epoch 144: 0.04392730743116276
avg loss in epoch 145: 0.04356576170010323
avg loss in epoch 146: 0.041687401540746745
avg loss in epoch 147: 0.044228294186971405
avg loss in epoch 148: 0.044084754391488706
avg loss in epoch 149: 0.04292880390262739
avg loss in epoch 150: 0.04367450495589186
avg loss in epoch 151: 0.04169267236085778
avg loss in epoch 152: 0.04473242741501467
avg loss in epoch 153: 0.043440781491385264
avg loss in epoch 154: 0.043026960285549816
avg loss in epoch 155: 0.04255032901313494
avg loss in epoch 156: 0.04123076781715182
avg loss in epoch 157: 0.04024856162934818
avg loss in epoch 158: 0.04017189210704104
avg loss in epoch 159: 0.042142635507678446
avg loss in epoch 160: 0.0422813125081699
Evaluating....................................................................................................................................................................................................epoch:160, time: 1410.887216(s), valid (NDCG@10: 0.2979, HR@10: 0.4326), test (NDCG@10: 0.2661, HR@10: 0.4011)
avg loss in epoch 161: 0.04017453365535899
avg loss in epoch 162: 0.043237471148710356
avg loss in epoch 163: 0.042123195503584364
avg loss in epoch 164: 0.041213345057754355
avg loss in epoch 165: 0.04039723034524782
avg loss in epoch 166: 0.04110096268017183
avg loss in epoch 167: 0.041532249422743917
avg loss in epoch 168: 0.04088513680141081
avg loss in epoch 169: 0.04099559119309892
avg loss in epoch 170: 0.0419971380721439
avg loss in epoch 171: 0.04393021811053834
avg loss in epoch 172: 0.043361244278705934
avg loss in epoch 173: 0.04033458241346208
avg loss in epoch 174: 0.04044819182970307
avg loss in epoch 175: 0.04046652963469652
avg loss in epoch 176: 0.041239446346563374
avg loss in epoch 177: 0.03999120824631642
avg loss in epoch 178: 0.0406490498942069
avg loss in epoch 179: 0.040445098230107265
avg loss in epoch 180: 0.0399324212604287
Evaluating....................................................................................................................................................................................................epoch:180, time: 1670.903649(s), valid (NDCG@10: 0.2902, HR@10: 0.4230), test (NDCG@10: 0.2668, HR@10: 0.4014)
avg loss in epoch 181: 0.04143911959942092
avg loss in epoch 182: 0.042021518827162006
avg loss in epoch 183: 0.045591725142334
avg loss in epoch 184: 0.04333061320622536
avg loss in epoch 185: 0.0422007810451429
avg loss in epoch 186: 0.03974633731625297
avg loss in epoch 187: 0.03781077797016637
avg loss in epoch 188: 0.040180673145435074
avg loss in epoch 189: 0.040177829754115504
avg loss in epoch 190: 0.04174223239533603
avg loss in epoch 191: 0.03916779924607412
avg loss in epoch 192: 0.04157744204117493
avg loss in epoch 193: 0.042636779666116294
avg loss in epoch 194: 0.042449938345023176
avg loss in epoch 195: 0.042835847262970426
avg loss in epoch 196: 0.041082379429347136
avg loss in epoch 197: 0.042153960623016414
avg loss in epoch 198: 0.04206325393170118
avg loss in epoch 199: 0.03972728685899214
avg loss in epoch 200: 0.040446801724928344
Evaluating....................................................................................................................................................................................................epoch:200, time: 1987.780571(s), valid (NDCG@10: 0.3023, HR@10: 0.4367), test (NDCG@10: 0.2637, HR@10: 0.3989)
Traceback (most recent call last):
  File "/root/autodl-tmp/users/liruijie/code/SASRec_original/recpJPQ/main.py", line 197, in <module>
    item_embeddings_torch = torch.stack(item_embeddings, dim=0)
  File "/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SASRec' object has no attribute 'item_code'
