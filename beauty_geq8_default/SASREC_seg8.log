nohup: ignoring input
average sequence length: 5.94
item_emb.weight: 4840000
pos_emb.weight: 80400
attention_layernorms.0.weight: 400
attention_layernorms.0.bias: 400
attention_layernorms.1.weight: 400
attention_layernorms.1.bias: 400
attention_layers.0.in_proj_weight: 480000
attention_layers.0.in_proj_bias: 1200
attention_layers.0.out_proj.weight: 160000
attention_layers.0.out_proj.bias: 400
attention_layers.1.in_proj_weight: 480000
attention_layers.1.in_proj_bias: 1200
attention_layers.1.out_proj.weight: 160000
attention_layers.1.out_proj.bias: 400
forward_layernorms.0.weight: 400
forward_layernorms.0.bias: 400
forward_layernorms.1.weight: 400
forward_layernorms.1.bias: 400
forward_layers.0.conv1.weight: 160000
forward_layers.0.conv1.bias: 400
forward_layers.0.conv2.weight: 160000
forward_layers.0.conv2.bias: 400
forward_layers.1.conv1.weight: 160000
forward_layers.1.conv1.bias: 400
forward_layers.1.conv2.weight: 160000
forward_layers.1.conv2.bias: 400
last_layernorm.weight: 400
last_layernorm.bias: 400
avg loss in epoch 1: 1.2187108546495438
avg loss in epoch 2: 1.0723221153020859
avg loss in epoch 3: 0.942458027465777
avg loss in epoch 4: 0.8044107312505896
avg loss in epoch 5: 0.6776510781862519
avg loss in epoch 6: 0.5597738132558085
avg loss in epoch 7: 0.4629867686466737
avg loss in epoch 8: 0.38514254784042184
avg loss in epoch 9: 0.3188991594043645
avg loss in epoch 10: 0.2720509757372466
avg loss in epoch 11: 0.23290311155671423
avg loss in epoch 12: 0.19812931154261937
avg loss in epoch 13: 0.1758656601675532
avg loss in epoch 14: 0.16101316921412945
avg loss in epoch 15: 0.14161407041617416
avg loss in epoch 16: 0.13010472804307938
avg loss in epoch 17: 0.12099777509204367
avg loss in epoch 18: 0.11020667546174744
avg loss in epoch 19: 0.10512342422523281
avg loss in epoch 20: 0.09947627732022242
Evaluating....................................................................................................................................................................................................epoch:20, time: 217.575070(s), valid (NDCG@10: 0.3170, HR@10: 0.4645), test (NDCG@10: 0.2924, HR@10: 0.4416)
Current best result: value_NDCG0.3169601522924978, value_HR0.4644819865662528, test_NDCG0.29244175418708007, test_HR0.44163523294933227
avg loss in epoch 21: 0.09406681917607784
avg loss in epoch 22: 0.08938845509493892
avg loss in epoch 23: 0.08685902108184317
avg loss in epoch 24: 0.08236504087901929
avg loss in epoch 25: 0.08161579169840975
avg loss in epoch 26: 0.08025874824009159
avg loss in epoch 27: 0.07571980860930952
avg loss in epoch 28: 0.07499516450546005
avg loss in epoch 29: 0.07212441655891863
avg loss in epoch 30: 0.07022501253099604
avg loss in epoch 31: 0.06856568297371268
avg loss in epoch 32: 0.06804670969193632
avg loss in epoch 33: 0.06548879943280057
avg loss in epoch 34: 0.06526809253475883
avg loss in epoch 35: 0.06399040639569814
avg loss in epoch 36: 0.0626682818613269
avg loss in epoch 37: 0.06177564693445509
avg loss in epoch 38: 0.060814542399550024
avg loss in epoch 39: 0.0586069219915027
avg loss in epoch 40: 0.06031116161664778
Evaluating....................................................................................................................................................................................................epoch:40, time: 358.987763(s), valid (NDCG@10: 0.3019, HR@10: 0.4443), test (NDCG@10: 0.2777, HR@10: 0.4202)
avg loss in epoch 41: 0.060340384233065626
avg loss in epoch 42: 0.05672849833287976
avg loss in epoch 43: 0.05882287715477022
avg loss in epoch 44: 0.05757583254440264
avg loss in epoch 45: 0.05676589542153207
avg loss in epoch 46: 0.057018335569988594
avg loss in epoch 47: 0.054671262856572866
avg loss in epoch 48: 0.05725380989976905
avg loss in epoch 49: 0.05365956193682822
avg loss in epoch 50: 0.053178214595060454
avg loss in epoch 51: 0.05319667937742038
avg loss in epoch 52: 0.05498478841036558
avg loss in epoch 53: 0.05191975235092369
avg loss in epoch 54: 0.05316770504313437
avg loss in epoch 55: 0.05292833420786668
avg loss in epoch 56: 0.051687574458562514
avg loss in epoch 57: 0.049978121924637395
avg loss in epoch 58: 0.05158273035406389
avg loss in epoch 59: 0.05329034155742689
avg loss in epoch 60: 0.05195211001079191
Evaluating....................................................................................................................................................................................................epoch:60, time: 676.430155(s), valid (NDCG@10: 0.2938, HR@10: 0.4356), test (NDCG@10: 0.2654, HR@10: 0.4057)
avg loss in epoch 61: 0.05157507437450642
avg loss in epoch 62: 0.04797640087252313
avg loss in epoch 63: 0.048637756167657
avg loss in epoch 64: 0.05027693704786626
avg loss in epoch 65: 0.04909783726642755
avg loss in epoch 66: 0.047565842724659226
avg loss in epoch 67: 0.047779206885024905
avg loss in epoch 68: 0.0514882068276744
avg loss in epoch 69: 0.05181528896686028
avg loss in epoch 70: 0.049304401777176696
avg loss in epoch 71: 0.051442490530792966
avg loss in epoch 72: 0.0488778924442489
avg loss in epoch 73: 0.048104488968171856
avg loss in epoch 74: 0.05046296862631359
avg loss in epoch 75: 0.04979876775971868
avg loss in epoch 76: 0.05077672870406373
avg loss in epoch 77: 0.04913200897333974
avg loss in epoch 78: 0.04692372802475637
avg loss in epoch 79: 0.046836660180071536
avg loss in epoch 80: 0.04726237854496999
Evaluating....................................................................................................................................................................................................epoch:80, time: 1125.542171(s), valid (NDCG@10: 0.2928, HR@10: 0.4325), test (NDCG@10: 0.2713, HR@10: 0.4113)
avg loss in epoch 81: 0.05060999131422828
avg loss in epoch 82: 0.05335954964076253
avg loss in epoch 83: 0.05094714845869352
avg loss in epoch 84: 0.0562423268460076
avg loss in epoch 85: 0.05753284931944853
avg loss in epoch 86: 0.04860074672085995
avg loss in epoch 87: 0.050853863189166244
avg loss in epoch 88: 0.04734991844320162
avg loss in epoch 89: 0.046653725799511776
avg loss in epoch 90: 0.048691999378868124
avg loss in epoch 91: 0.04783791045404293
avg loss in epoch 92: 0.04901228083128279
avg loss in epoch 93: 0.04939488480290906
avg loss in epoch 94: 0.04593169621445916
avg loss in epoch 95: 0.05441917373206128
avg loss in epoch 96: 0.047305764397606254
avg loss in epoch 97: 0.04709920630028302
avg loss in epoch 98: 0.05073217042213814
avg loss in epoch 99: 0.050458017969504
avg loss in epoch 100: 0.051855041306804524
Evaluating....................................................................................................................................................................................................epoch:100, time: 1587.020903(s), valid (NDCG@10: 0.2941, HR@10: 0.4296), test (NDCG@10: 0.2673, HR@10: 0.4022)
avg loss in epoch 101: 0.05148544422858818
avg loss in epoch 102: 0.04587412358854304
avg loss in epoch 103: 0.04579842571084472
avg loss in epoch 104: 0.05073975536718287
avg loss in epoch 105: 0.04343941708264703
avg loss in epoch 106: 0.04612442351539026
avg loss in epoch 107: 0.04371823539788073
avg loss in epoch 108: 0.04662716255353933
avg loss in epoch 109: 0.04827635470693084
avg loss in epoch 110: 0.04855710471218282
avg loss in epoch 111: 0.0455252409870313
avg loss in epoch 112: 0.045329463287171995
avg loss in epoch 113: 0.04609706830656664
avg loss in epoch 114: 0.04553993289697577
avg loss in epoch 115: 0.047161068597977814
avg loss in epoch 116: 0.044928650075400416
avg loss in epoch 117: 0.046509586803784427
avg loss in epoch 118: 0.04322836353358897
avg loss in epoch 119: 0.04599762060256167
avg loss in epoch 120: 0.04559551920233802
Evaluating....................................................................................................................................................................................................epoch:120, time: 1923.749789(s), valid (NDCG@10: 0.2985, HR@10: 0.4348), test (NDCG@10: 0.2676, HR@10: 0.4040)
avg loss in epoch 121: 0.04423401225358248
avg loss in epoch 122: 0.042804807488044556
avg loss in epoch 123: 0.04368759698065167
avg loss in epoch 124: 0.044175737114115196
avg loss in epoch 125: 0.044256241314790466
avg loss in epoch 126: 0.04211380838585848
avg loss in epoch 127: 0.04178889030167325
avg loss in epoch 128: 0.043341679689051074
avg loss in epoch 129: 0.04408132039349188
avg loss in epoch 130: 0.04431556556797163
avg loss in epoch 131: 0.040028435813093725
avg loss in epoch 132: 0.04301209559410133
avg loss in epoch 133: 0.04170423790558495
avg loss in epoch 134: 0.04185936379839073
avg loss in epoch 135: 0.042741575109010395
avg loss in epoch 136: 0.04112912485883995
avg loss in epoch 137: 0.04096082800110294
avg loss in epoch 138: 0.042363418033346534
avg loss in epoch 139: 0.0421241901984269
avg loss in epoch 140: 0.04040842228145762
Evaluating....................................................................................................................................................................................................epoch:140, time: 2232.254189(s), valid (NDCG@10: 0.2882, HR@10: 0.4240), test (NDCG@10: 0.2621, HR@10: 0.3981)
avg loss in epoch 141: 0.04268415206619962
avg loss in epoch 142: 0.044807981424541635
avg loss in epoch 143: 0.04447399181398479
avg loss in epoch 144: 0.04361580045555125
avg loss in epoch 145: 0.04232397681864148
avg loss in epoch 146: 0.046269614693962714
avg loss in epoch 147: 0.04726759454404766
avg loss in epoch 148: 0.051793470280244946
avg loss in epoch 149: 0.04707651646723124
avg loss in epoch 150: 0.04513325535861606
avg loss in epoch 151: 0.04420780934478072
avg loss in epoch 152: 0.044147513044828716
avg loss in epoch 153: 0.044249024538492616
avg loss in epoch 154: 0.04368318924257024
avg loss in epoch 155: 0.04069849920713089
avg loss in epoch 156: 0.042825126089155674
avg loss in epoch 157: 0.04523057300089435
avg loss in epoch 158: 0.04521014623936604
avg loss in epoch 159: 0.04716661117378284
avg loss in epoch 160: 0.04628860287960957
Evaluating....................................................................................................................................................................................................epoch:160, time: 2680.035592(s), valid (NDCG@10: 0.2957, HR@10: 0.4292), test (NDCG@10: 0.2636, HR@10: 0.4045)
avg loss in epoch 161: 0.04278262873942202
avg loss in epoch 162: 0.04583387474783442
avg loss in epoch 163: 0.042848119088871914
avg loss in epoch 164: 0.038896004648201844
avg loss in epoch 165: 0.04129309594546529
avg loss in epoch 166: 0.04233394876461138
avg loss in epoch 167: 0.040329336654394865
avg loss in epoch 168: 0.042244511444798925
avg loss in epoch 169: 0.040070982819253746
avg loss in epoch 170: 0.04367361721498045
avg loss in epoch 171: 0.04521225329319185
avg loss in epoch 172: 0.048003569139506326
avg loss in epoch 173: 0.04322938513095406
avg loss in epoch 174: 0.04141575743613595
avg loss in epoch 175: 0.04298672812398185
avg loss in epoch 176: 0.041329364609819924
avg loss in epoch 177: 0.04160866968926381
avg loss in epoch 178: 0.04001037240959704
avg loss in epoch 179: 0.03825747995341027
avg loss in epoch 180: 0.04101635035212067
Evaluating....................................................................................................................................................................................................epoch:180, time: 2982.801146(s), valid (NDCG@10: 0.2911, HR@10: 0.4281), test (NDCG@10: 0.2660, HR@10: 0.4036)
avg loss in epoch 181: 0.04072004804303023
avg loss in epoch 182: 0.040035760516978124
avg loss in epoch 183: 0.043669058539142665
avg loss in epoch 184: 0.053188248368149456
avg loss in epoch 185: 0.044816991885785355
avg loss in epoch 186: 0.04505270670845427
avg loss in epoch 187: 0.039968032516877756
avg loss in epoch 188: 0.04279136498966678
avg loss in epoch 189: 0.041808522179384126
avg loss in epoch 190: 0.04652135541916571
avg loss in epoch 191: 0.047875462311574
avg loss in epoch 192: 0.046150792093778197
avg loss in epoch 193: 0.043505663369697606
avg loss in epoch 194: 0.04143862083384937
avg loss in epoch 195: 0.04440708837302571
avg loss in epoch 196: 0.04181597974490036
avg loss in epoch 197: 0.04076790695332668
avg loss in epoch 198: 0.04415973273783245
avg loss in epoch 199: 0.038866337230005724
avg loss in epoch 200: 0.04632999680259011
Evaluating....................................................................................................................................................................................................epoch:200, time: 3222.473475(s), valid (NDCG@10: 0.2963, HR@10: 0.4313), test (NDCG@10: 0.2703, HR@10: 0.4101)
Traceback (most recent call last):
  File "/root/autodl-tmp/users/liruijie/code/SASRec_original/recpJPQ/main.py", line 197, in <module>
    item_embeddings_torch = torch.stack(item_embeddings, dim=0)
  File "/root/autodl-tmp/users/liruijie/anaconda3/envs/VimCnnTrans/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1695, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'SASRec' object has no attribute 'item_code'
